(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,13353,t=>{"use strict";var e=t.i(33901);class i extends e.Scene{gridX;gridY;goalX;goalY;tileSize;walkSpeed;movesRemaining;maxMoves;onNoMoves;onWin;addMoreMoves;maze;player;goal;winText;movesText;enemies;bullets;fireBtn;upBtn;downBtn;leftBtn;rightBtn;moving;playerTween;lastDir;cursors;wKey;aKey;sKey;dKey;constructor(){super("MazeScene")}preload(){this.load.spritesheet("avatar","https://labs.phaser.io/assets/sprites/dude.png",{frameWidth:32,frameHeight:48}),this.load.image("goal","https://labs.phaser.io/assets/sprites/star.png"),this.load.image("wall","/assets/tinified/tile-green-1.png"),this.load.image("enemy","/assets/tinified/little-menace.png"),this.load.image("bullet","https://labs.phaser.io/assets/sprites/bullet.png")}create(){this.tileSize=24,this.walkSpeed=70,this.maxMoves=this.registry.get("maxMoves")||5,this.movesRemaining=this.maxMoves,this.onNoMoves=this.registry.get("onNoMoves")||(()=>{}),this.onWin=this.registry.get("onWin")||(()=>{}),this.addMoreMoves=this.registry.get("addMoreMoves")||(t=>{}),this.cameras.main.setBackgroundColor("#9C27B0"),this.maze=this.generateMaze(21,21);for(let t=0;t<21;t++)for(let e=0;e<21;e++)1===this.maze[t][e]&&this.add.image(e*this.tileSize,t*this.tileSize,"wall").setOrigin(0).setDisplaySize(this.tileSize,this.tileSize);this.gridX=1,this.gridY=1,this.goalX=19,this.goalY=19,this.player=this.add.sprite(this.gridX*this.tileSize,this.gridY*this.tileSize,"avatar",4).setOrigin(0).setDisplaySize(this.tileSize,this.tileSize),this.goal=this.add.sprite(this.goalX*this.tileSize,this.goalY*this.tileSize,"goal").setOrigin(0).setDisplaySize(this.tileSize,this.tileSize),this.winText=this.add.text(100,200,"YOU WIN!",{fontSize:"32px",color:"#fff"}).setVisible(!1),this.movesText=this.add.text(10,10,`Moves: ${this.movesRemaining}/${this.maxMoves}`,{fontSize:"18px",color:"#fff"}).setOrigin(0),this.anims.create({key:"left",frames:this.anims.generateFrameNumbers("avatar",{start:0,end:3}),frameRate:10,repeat:-1}),this.anims.create({key:"right",frames:this.anims.generateFrameNumbers("avatar",{start:5,end:8}),frameRate:10,repeat:-1}),this.moving=!1,this.playerTween=null,this.lastDir={dx:1,dy:0},this.enemies=this.physics.add.group();for(let t=0;t<5;t++){let t=e.Math.Between(2,18),i=e.Math.Between(2,18);if(0===this.maze[i][t]&&(1!==t||1!==i)){let e=this.enemies.create(t*this.tileSize,i*this.tileSize,"enemy").setOrigin(0).setDisplaySize(this.tileSize,this.tileSize);e.gridX=t,e.gridY=i}}this.bullets=this.physics.add.group(),this.physics.add.overlap(this.bullets,this.enemies,(t,e)=>{"gameObject"in t&&t.gameObject.destroy(),"gameObject"in e&&e.gameObject.destroy()});let t=Number(this.sys.game.config.width)/2,i=Number(this.sys.game.config.height)-105;this.fireBtn=this.add.text(t+150,i,"ðŸ”¥",{fontSize:"64px"}).setOrigin(.5).setInteractive(),this.fireBtn.on("pointerdown",()=>this.fireWeapon()),this.upBtn=this.add.text(t,i-70,"â¬†ï¸",{fontSize:"64px"}).setOrigin(.5).setInteractive(),this.downBtn=this.add.text(t,i+70,"â¬‡ï¸",{fontSize:"64px"}).setOrigin(.5).setInteractive(),this.leftBtn=this.add.text(t-70,i,"â¬…ï¸",{fontSize:"64px"}).setOrigin(.5).setInteractive(),this.rightBtn=this.add.text(t+70,i,"âž¡ï¸",{fontSize:"64px"}).setOrigin(.5).setInteractive(),this.upBtn.on("pointerdown",()=>this.autoWalk({dx:0,dy:-1,anim:"right"})),this.downBtn.on("pointerdown",()=>this.autoWalk({dx:0,dy:1,anim:"left"})),this.leftBtn.on("pointerdown",()=>this.autoWalk({dx:-1,dy:0,anim:"left"})),this.rightBtn.on("pointerdown",()=>this.autoWalk({dx:1,dy:0,anim:"right"})),this.input.keyboard&&(this.cursors=this.input.keyboard.createCursorKeys()),this.wKey=this.input.keyboard.addKey(e.Input.Keyboard.KeyCodes.W),this.aKey=this.input.keyboard.addKey(e.Input.Keyboard.KeyCodes.A),this.sKey=this.input.keyboard.addKey(e.Input.Keyboard.KeyCodes.S),this.dKey=this.input.keyboard.addKey(e.Input.Keyboard.KeyCodes.D)}update(){e.Input.Keyboard.JustDown(this.cursors.up)&&this.autoWalk({dx:0,dy:-1,anim:"right"}),e.Input.Keyboard.JustDown(this.cursors.down)&&this.autoWalk({dx:0,dy:1,anim:"left"}),e.Input.Keyboard.JustDown(this.cursors.left)&&this.autoWalk({dx:-1,dy:0,anim:"left"}),e.Input.Keyboard.JustDown(this.cursors.right)&&this.autoWalk({dx:1,dy:0,anim:"right"}),e.Input.Keyboard.JustDown(this.wKey)&&this.autoWalk({dx:0,dy:-1,anim:"right"}),e.Input.Keyboard.JustDown(this.sKey)&&this.autoWalk({dx:0,dy:1,anim:"left"}),e.Input.Keyboard.JustDown(this.aKey)&&this.autoWalk({dx:-1,dy:0,anim:"left"}),e.Input.Keyboard.JustDown(this.dKey)&&this.autoWalk({dx:1,dy:0,anim:"right"})}fireWeapon(){let t=this.bullets.create(this.player.x,this.player.y,"bullet").setOrigin(0).setDisplaySize(this.tileSize/2,this.tileSize/2);this.physics.velocityFromRotation(e.Math.Angle.Between(0,0,this.lastDir.dx,this.lastDir.dy),200,t.body.velocity)}autoWalk(t){if(this.moving)return;if(this.movesRemaining<=0){this.onNoMoves&&this.onNoMoves();return}this.moving=!0,this.lastDir=t,this.playerTween&&this.playerTween.isPlaying()&&(this.playerTween.stop(),this.playerTween=null,this.player.anims.stop());let e=this.gridX,i=this.gridY,s=0;for(;;){let a=e+t.dx,h=i+t.dy;if(!this.isPath(a,h)||this.enemies.getChildren().some(t=>t.gridX===a&&t.gridY===h)||(e=a,i=h,s++,e===this.goalX&&i===this.goalY||2!==this.degree(e,i)))break}if(0===s){this.moving=!1;return}this.player.anims.play(t.anim,!0),this.playerTween=this.tweens.add({targets:this.player,x:e*this.tileSize,y:i*this.tileSize,duration:Math.max(1,this.walkSpeed*s),ease:"Linear",onComplete:()=>{this.gridX=e,this.gridY=i,this.player.setPosition(this.gridX*this.tileSize,this.gridY*this.tileSize),this.player.anims.stop(),this.player.setFrame(4),this.moving=!1,this.playerTween=null,this.movesRemaining--,this.movesText&&this.movesText.setText(`Moves: ${this.movesRemaining}/${this.maxMoves}`),this.gridX===this.goalX&&this.gridY===this.goalY&&(this.winText.setVisible(!0),this.onWin())}})}isPath(t,e){return e>=0&&e<this.maze.length&&t>=0&&t<this.maze[0].length&&0===this.maze[e][t]}degree(t,e){let i=0;for(let s of[{dx:0,dy:-1},{dx:1,dy:0},{dx:0,dy:1},{dx:-1,dy:0}])this.isPath(t+s.dx,e+s.dy)&&i++;return i}addMoreMovesToScene(t){this.maxMoves=t,this.movesRemaining=t,this.movesText&&this.movesText.setText(`Moves: ${this.movesRemaining}/${this.maxMoves}`)}generateMaze(t,i){let s=Array.from({length:t},()=>Array(i).fill(1)),a=[],h={x:1,y:1};s[h.y][h.x]=0,a.push(h);let r=[{dx:0,dy:-2},{dx:2,dy:0},{dx:0,dy:2},{dx:-2,dy:0}];for(;a.length;){let h=a[a.length-1];e.Utils.Array.Shuffle(r);let n=r.map(t=>({x:h.x+t.dx,y:h.y+t.dy,dx:t.dx,dy:t.dy})).filter(e=>e.x>0&&e.x<i-1&&e.y>0&&e.y<t-1&&1===s[e.y][e.x]);if(n.length){let t=n[0];if(s[t.y][t.x]=0,s[h.y+t.dy/2][h.x+t.dx/2]=0,a.push(t),n.length>1&&.3>Math.random()){let t=n[1];s[t.y][t.x]=0,s[h.y+t.dy/2][h.x+t.dx/2]=0}}else a.pop()}return s}}t.s(["MazeScene",()=>i])}]);